<pre style='background-color:blue;'>
<font color='blue'>
 public static void shellSort(int[] arr) {
      int inner, outer;
      int temp;

      int h = 1;
      while (h &lt;= arr.length / 3) {
         h = h * 3 + 1;
      }
      while (h &gt; 0) {
         for (outer = h; outer &lt; arr.length; outer++) {
            temp = arr[outer];
            inner = outer;

            while (inner &gt; h - 1 &amp;&amp; arr[inner - h] &gt;= temp) {
               arr[inner] = arr[inner - h];
               inner -= h;
            }
            arr[inner] = temp;
         }
         h = (h - 1) / 3;
      }
   }  </font>
</pre>
<pre style='background-color:blue;'>
<font color='blue'>
package chapter4.section2;

import chapter1.section3.Queue;
import edu.princeton.cs.algs4.StdOut;


public class Exercise39_QueueBasedTopologicalSort {

    private int[] ranks;

    
    public int[] topologicalSort(Digraph digraph) <font color='#ff0000' weight='1' id='558'>{

        <font color='#ff0000' weight='1' id='100'>DirectedCycle directedCycle <font color='#ff0000' weight='1' id='97'>= <font color='#ff0000' weight='1' id='96'><font color='#ff0000' weight='1' id='86'>new<font color='#ff0000' weight='1' id='85'></font> </font><font color='#ff0000' weight='1' id='95'><font color='#ff0000' weight='1' id='88'>DirectedCycle<font color='#ff0000' weight='1' id='87'></font></font><font color='#ff0000' weight='1' id='94'>(<font color='#ff0000' weight='1' id='92'><font color='#ff0000' weight='1' id='91'><font color='#ff0000' weight='1' id='90'>digraph<font color='#ff0000' weight='1' id='89'></font></font></font>)</font><font color='#ff0000' weight='1' id='93'></font></font></font></font></font>;<font color='#ff0000' weight='1' id='99'></font>
        </font><font color='#ff0000' weight='1' id='122'>if<font color='#ff0000' weight='1' id='113'>(<font color='#ff0000' weight='1' id='111'><font color='#ff0000' weight='1' id='110'><font color='#ff0000' weight='1' id='107'><font color='#ff0000' weight='1' id='102'>directedCycle</font><font color='#ff0000' weight='1' id='104'>.<font color='#ff0000' weight='1' id='103'></font></font><font color='#ff0000' weight='1' id='106'>hasCycle<font color='#ff0000' weight='1' id='105'></font></font></font><font color='#ff0000' weight='1' id='109'>()<font color='#ff0000' weight='1' id='108'></font></font></font>)</font><font color='#ff0000' weight='1' id='112'></font></font><font color='#ff0000' weight='1' id='121'> <font color='#ff0000' weight='1' id='120'>{
            
            <font color='#ff0000' weight='1' id='118'>return <font color='#ff0000' weight='1' id='116'><font color='#ff0000' weight='1' id='115'>null<font color='#ff0000' weight='1' id='114'></font></font>;</font><font color='#ff0000' weight='1' id='117'></font>
        }</font><font color='#ff0000' weight='1' id='119'></font></font></font>

        </font><font color='#ff0000' weight='1' id='127'><font color='#ff0000' weight='1' id='124'>int</font><font color='#ff0000' weight='1' id='126'>[]<font color='#ff0000' weight='1' id='125'></font></font></font> indegree <font color='#ff0000' weight='1' id='150'>= <font color='#ff0000' weight='1' id='149'><font color='#ff0000' weight='1' id='132'>new<font color='#ff0000' weight='1' id='131'></font> </font><font color='#ff0000' weight='1' id='148'><font color='#ff0000' weight='1' id='134'>int<font color='#ff0000' weight='1' id='133'></font></font><font color='#ff0000' weight='1' id='147'>[<font color='#ff0000' weight='1' id='145'><font color='#ff0000' weight='1' id='144'><font color='#ff0000' weight='1' id='141'><font color='#ff0000' weight='1' id='136'>digraph<font color='#ff0000' weight='1' id='135'></font></font><font color='#ff0000' weight='1' id='138'>.<font color='#ff0000' weight='1' id='137'></font></font><font color='#ff0000' weight='1' id='140'>vertices<font color='#ff0000' weight='1' id='139'></font></font></font><font color='#ff0000' weight='1' id='143'>()<font color='#ff0000' weight='1' id='142'></font></font></font>]</font><font color='#ff0000' weight='1' id='146'></font></font></font></font></font>;
        <font color='#ff0000' weight='1' id='161'><font color='#ff0000' weight='1' id='155'>Queue</font><font color='#ff0000' weight='1' id='160'>&lt;<font color='#ff0000' weight='1' id='158'><font color='#ff0000' weight='1' id='157'>Integer<font color='#ff0000' weight='1' id='156'></font></font>&gt;</font><font color='#ff0000' weight='1' id='159'></font></font></font> sources = <font color='#ff0000' weight='1' id='166'>new<font color='#ff0000' weight='1' id='165'></font> </font><font color='#ff0000' weight='1' id='174'><font color='#ff0000' weight='1' id='171'><font color='#ff0000' weight='1' id='168'>Queue<font color='#ff0000' weight='1' id='167'></font></font><font color='#ff0000' weight='1' id='170'>&lt;&gt;<font color='#ff0000' weight='1' id='169'></font></font></font><font color='#ff0000' weight='1' id='173'>()<font color='#ff0000' weight='1' id='172'></font></font></font>;

        <font color='#ff0000' weight='1' id='204'><font color='#ff0000' weight='1' id='202'>ranks = <font color='#ff0000' weight='1' id='185'>new<font color='#ff0000' weight='1' id='184'></font> </font><font color='#ff0000' weight='1' id='201'><font color='#ff0000' weight='1' id='187'>int<font color='#ff0000' weight='1' id='186'></font></font><font color='#ff0000' weight='1' id='200'>[<font color='#ff0000' weight='1' id='198'><font color='#ff0000' weight='1' id='197'><font color='#ff0000' weight='1' id='194'>digraph.vertices</font><font color='#ff0000' weight='1' id='196'>()<font color='#ff0000' weight='1' id='195'></font></font></font>]</font><font color='#ff0000' weight='1' id='199'></font></font></font>;</font><font color='#ff0000' weight='1' id='203'></font>

        </font><font color='#ff0000' weight='1' id='235'><font color='#ff0000' weight='1' id='233'><font color='#ff0000' weight='1' id='210'><font color='#ff0000' weight='1' id='209'><font color='#ff0000' weight='1' id='206'>int</font><font color='#ff0000' weight='1' id='208'>[]<font color='#ff0000' weight='1' id='207'></font></font></font> </font><font color='#ff0000' weight='1' id='212'>topologicalSort </font><font color='#ff0000' weight='1' id='232'>= <font color='#ff0000' weight='1' id='231'>new <font color='#ff0000' weight='1' id='230'><font color='#ff0000' weight='1' id='216'>int<font color='#ff0000' weight='1' id='215'></font></font><font color='#ff0000' weight='1' id='229'>[<font color='#ff0000' weight='1' id='227'><font color='#ff0000' weight='1' id='226'><font color='#ff0000' weight='1' id='223'><font color='#ff0000' weight='1' id='218'>digraph<font color='#ff0000' weight='1' id='217'></font></font><font color='#ff0000' weight='1' id='220'>.</font><font color='#ff0000' weight='1' id='222'>vertices<font color='#ff0000' weight='1' id='221'></font></font></font><font color='#ff0000' weight='1' id='225'>()<font color='#ff0000' weight='1' id='224'></font></font></font>]</font><font color='#ff0000' weight='1' id='228'></font></font></font></font></font>;</font><font color='#ff0000' weight='1' id='234'></font>
        </font><font color='#ff0000' weight='1' id='247'><font color='#ff0000' weight='1' id='245'><font color='#ff0000' weight='1' id='238'><font color='#ff0000' weight='1' id='237'>int</font> </font><font color='#ff0000' weight='1' id='240'>topologicalSortIndex<font color='#ff0000' weight='1' id='239'></font> </font><font color='#ff0000' weight='1' id='244'>= <font color='#ff0000' weight='1' id='243'>0</font></font>;</font><font color='#ff0000' weight='1' id='246'></font>

        </font><font color='#ff0000' weight='1' id='328'>for(<font color='#ff0000' weight='1' id='257'><font color='#ff0000' weight='1' id='250'><font color='#ff0000' weight='1' id='249'>int</font> </font><font color='#ff0000' weight='1' id='252'>vertex </font><font color='#ff0000' weight='1' id='256'>= <font color='#ff0000' weight='1' id='255'><font color='#ff0000' weight='1' id='254'>0<font color='#ff0000' weight='1' id='253'></font></font></font></font>;</font><font color='#ff0000' weight='1' id='258'></font> vertex &lt; <font color='#ff0000' weight='1' id='273'><font color='#ff0000' weight='1' id='270'>digraph.vertices</font><font color='#ff0000' weight='1' id='272'>()<font color='#ff0000' weight='1' id='271'></font></font></font>; vertex++) <font color='#ff0000' weight='1' id='327'>{
            <font color='#ff0000' weight='1' id='325'>for<font color='#ff0000' weight='1' id='309'>(<font color='#ff0000' weight='1' id='307'><font color='#ff0000' weight='1' id='306'><font color='#ff0000' weight='1' id='287'><font color='#ff0000' weight='1' id='286'>int</font> </font><font color='#ff0000' weight='1' id='289'>neighbor<font color='#ff0000' weight='1' id='288'></font> </font><font color='#ff0000' weight='1' id='305'>: <font color='#ff0000' weight='1' id='304'><font color='#ff0000' weight='1' id='303'><font color='#ff0000' weight='1' id='296'><font color='#ff0000' weight='1' id='291'>digraph<font color='#ff0000' weight='1' id='290'></font></font><font color='#ff0000' weight='1' id='293'>.</font><font color='#ff0000' weight='1' id='295'>adjacent<font color='#ff0000' weight='1' id='294'></font></font></font><font color='#ff0000' weight='1' id='302'>(<font color='#ff0000' weight='1' id='300'><font color='#ff0000' weight='1' id='299'><font color='#ff0000' weight='1' id='298'>vertex<font color='#ff0000' weight='1' id='297'></font></font></font>)</font><font color='#ff0000' weight='1' id='301'></font></font></font></font></font></font>)</font><font color='#ff0000' weight='1' id='308'></font> </font><font color='#ff0000' weight='1' id='324'>{
                <font color='#ff0000' weight='1' id='322'><font color='#ff0000' weight='1' id='320'>indegree[neighbor]<font color='#ff0000' weight='1' id='319'>++<font color='#ff0000' weight='1' id='318'></font></font>;</font><font color='#ff0000' weight='1' id='321'></font>
            }</font><font color='#ff0000' weight='1' id='323'></font></font>
        }</font><font color='#ff0000' weight='1' id='326'></font></font>

        </font><font color='#ff0000' weight='1' id='404'>for<font color='#ff0000' weight='1' id='365'>(<font color='#ff0000' weight='1' id='340'><font color='#ff0000' weight='1' id='338'><font color='#ff0000' weight='1' id='331'><font color='#ff0000' weight='1' id='330'>int<font color='#ff0000' weight='1' id='329'></font></font> </font><font color='#ff0000' weight='1' id='333'>vertex<font color='#ff0000' weight='1' id='332'></font> </font><font color='#ff0000' weight='1' id='337'>= <font color='#ff0000' weight='1' id='336'><font color='#ff0000' weight='1' id='335'>0<font color='#ff0000' weight='1' id='334'></font></font></font></font>;</font><font color='#ff0000' weight='1' id='339'></font> </font><font color='#ff0000' weight='1' id='357'><font color='#ff0000' weight='1' id='355'>vertex &lt; <font color='#ff0000' weight='1' id='354'><font color='#ff0000' weight='1' id='351'><font color='#ff0000' weight='1' id='346'>digraph</font><font color='#ff0000' weight='1' id='348'>.<font color='#ff0000' weight='1' id='347'></font></font><font color='#ff0000' weight='1' id='350'>vertices<font color='#ff0000' weight='1' id='349'></font></font></font><font color='#ff0000' weight='1' id='353'>()<font color='#ff0000' weight='1' id='352'></font></font></font>;</font><font color='#ff0000' weight='1' id='356'></font> </font><font color='#ff0000' weight='1' id='363'><font color='#ff0000' weight='1' id='362'>vertex++</font>)</font><font color='#ff0000' weight='1' id='364'></font> </font><font color='#ff0000' weight='1' id='403'>{
            <font color='#ff0000' weight='1' id='401'>if<font color='#ff0000' weight='1' id='380'>(<font color='#ff0000' weight='1' id='378'><font color='#ff0000' weight='1' id='373'><font color='#ff0000' weight='1' id='367'>indegree</font><font color='#ff0000' weight='1' id='372'>[<font color='#ff0000' weight='1' id='370'><font color='#ff0000' weight='1' id='369'>vertex<font color='#ff0000' weight='1' id='368'></font></font>]</font><font color='#ff0000' weight='1' id='371'></font></font> </font>== 0)</font><font color='#ff0000' weight='1' id='379'></font></font><font color='#ff0000' weight='1' id='400'> <font color='#ff0000' weight='1' id='399'>{
                <font color='#ff0000' weight='1' id='397'><font color='#ff0000' weight='1' id='395'><font color='#ff0000' weight='1' id='394'><font color='#ff0000' weight='1' id='387'><font color='#ff0000' weight='1' id='382'>sources<font color='#ff0000' weight='1' id='381'></font></font><font color='#ff0000' weight='1' id='384'>.</font>enqueue</font><font color='#ff0000' weight='1' id='393'>(<font color='#ff0000' weight='1' id='391'><font color='#ff0000' weight='1' id='390'><font color='#ff0000' weight='1' id='389'>vertex<font color='#ff0000' weight='1' id='388'></font></font></font>)</font><font color='#ff0000' weight='1' id='392'></font></font></font>;</font><font color='#ff0000' weight='1' id='396'></font>
            }</font><font color='#ff0000' weight='1' id='398'></font></font></font>
        }</font><font color='#ff0000' weight='1' id='402'></font></font>

        </font><font color='#ff0000' weight='1' id='551'>while <font color='#ff0000' weight='1' id='419'>(<font color='#ff0000' weight='1' id='417'><font color='#ff0000' weight='1' id='406'>!<font color='#ff0000' weight='1' id='405'></font></font><font color='#ff0000' weight='1' id='416'><font color='#ff0000' weight='1' id='413'><font color='#ff0000' weight='1' id='408'>sources</font><font color='#ff0000' weight='1' id='410'>.</font><font color='#ff0000' weight='1' id='412'>isEmpty</font></font><font color='#ff0000' weight='1' id='415'>()<font color='#ff0000' weight='1' id='414'></font></font></font>)</font><font color='#ff0000' weight='1' id='418'></font> </font><font color='#ff0000' weight='1' id='550'>{
            <font color='#ff0000' weight='1' id='439'><font color='#ff0000' weight='1' id='437'><font color='#ff0000' weight='1' id='422'><font color='#ff0000' weight='1' id='421'>int<font color='#ff0000' weight='1' id='420'></font></font> </font><font color='#ff0000' weight='1' id='424'>currentSource<font color='#ff0000' weight='1' id='423'></font> </font><font color='#ff0000' weight='1' id='436'>= <font color='#ff0000' weight='1' id='435'><font color='#ff0000' weight='1' id='434'><font color='#ff0000' weight='1' id='431'><font color='#ff0000' weight='1' id='426'>sources<font color='#ff0000' weight='1' id='425'></font></font><font color='#ff0000' weight='1' id='428'>.</font><font color='#ff0000' weight='1' id='430'>dequeue</font></font><font color='#ff0000' weight='1' id='433'>()<font color='#ff0000' weight='1' id='432'></font></font></font></font></font>;</font><font color='#ff0000' weight='1' id='438'></font>

            </font><font color='#ff0000' weight='1' id='454'><font color='#ff0000' weight='1' id='452'>ranks[currentSource] = <font color='#ff0000' weight='1' id='451'>topologicalSortIndex<font color='#ff0000' weight='1' id='450'></font></font>;</font><font color='#ff0000' weight='1' id='453'></font>
            </font><font color='#ff0000' weight='1' id='471'><font color='#ff0000' weight='1' id='469'>topologicalSort[topologicalSortIndex++] <font color='#ff0000' weight='1' id='466'>=<font color='#ff0000' weight='1' id='465'></font> </font><font color='#ff0000' weight='1' id='468'>currentSource<font color='#ff0000' weight='1' id='467'></font></font>;</font><font color='#ff0000' weight='1' id='470'></font>

            </font><font color='#ff0000' weight='1' id='548'>for<font color='#ff0000' weight='1' id='496'>(<font color='#ff0000' weight='1' id='494'><font color='#ff0000' weight='1' id='493'><font color='#ff0000' weight='1' id='474'><font color='#ff0000' weight='1' id='473'>int</font> </font><font color='#ff0000' weight='1' id='476'>neighbor<font color='#ff0000' weight='1' id='475'></font> </font><font color='#ff0000' weight='1' id='492'>: <font color='#ff0000' weight='1' id='491'><font color='#ff0000' weight='1' id='490'><font color='#ff0000' weight='1' id='483'><font color='#ff0000' weight='1' id='478'>digraph<font color='#ff0000' weight='1' id='477'></font></font><font color='#ff0000' weight='1' id='480'>.</font><font color='#ff0000' weight='1' id='482'>adjacent</font></font><font color='#ff0000' weight='1' id='489'>(<font color='#ff0000' weight='1' id='487'><font color='#ff0000' weight='1' id='486'><font color='#ff0000' weight='1' id='485'>currentSource<font color='#ff0000' weight='1' id='484'></font></font></font>)</font><font color='#ff0000' weight='1' id='488'></font></font></font></font></font></font>)</font><font color='#ff0000' weight='1' id='495'></font> </font><font color='#ff0000' weight='1' id='547'>{
                indegree[neighbor]--;

                <font color='#ff0000' weight='1' id='545'>if<font color='#ff0000' weight='1' id='524'>(<font color='#ff0000' weight='1' id='522'><font color='#ff0000' weight='1' id='517'><font color='#ff0000' weight='1' id='511'>indegree<font color='#ff0000' weight='1' id='510'></font></font><font color='#ff0000' weight='1' id='516'>[<font color='#ff0000' weight='1' id='514'>neighbor]</font><font color='#ff0000' weight='1' id='515'></font></font> </font>== <font color='#ff0000' weight='1' id='521'>0<font color='#ff0000' weight='1' id='520'></font></font>)</font><font color='#ff0000' weight='1' id='523'></font></font><font color='#ff0000' weight='1' id='544'> <font color='#ff0000' weight='1' id='543'>{
                    <font color='#ff0000' weight='1' id='541'><font color='#ff0000' weight='1' id='539'><font color='#ff0000' weight='1' id='538'><font color='#ff0000' weight='1' id='531'><font color='#ff0000' weight='1' id='526'>sources</font><font color='#ff0000' weight='1' id='528'>.</font><font color='#ff0000' weight='1' id='530'>enqueue<font color='#ff0000' weight='1' id='529'></font></font></font><font color='#ff0000' weight='1' id='537'>(<font color='#ff0000' weight='1' id='535'><font color='#ff0000' weight='1' id='534'><font color='#ff0000' weight='1' id='533'>neighbor<font color='#ff0000' weight='1' id='532'></font></font></font>)</font><font color='#ff0000' weight='1' id='536'></font></font></font>;</font><font color='#ff0000' weight='1' id='540'></font>
                }</font><font color='#ff0000' weight='1' id='542'></font></font></font>
            }</font></font>
        }</font></font>

        </font><font color='#ff0000' weight='1' id='556'>return <font color='#ff0000' weight='1' id='554'><font color='#ff0000' weight='1' id='553'>topologicalSort<font color='#ff0000' weight='1' id='552'></font></font>;</font><font color='#ff0000' weight='1' id='555'></font>
    }</font><font color='#ff0000' weight='1' id='557'></font></font>

}
</font>
</pre>

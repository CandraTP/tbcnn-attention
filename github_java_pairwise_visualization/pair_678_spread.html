<pre style='background-color:blue;'>
<font color='blue'>
import java.util.Arrays;

public class HeapSortSelectHeap {

    public enum Heap { MINHEAP, MAXHEAP };

    private Heap heap;

    public HeapSortSelectHeap(Heap heap) {
        this.heap = heap;
    }

    private void swap(int[] list, int i, int j) {
        int temp = list[j];
        list[j] = list[i];
        list[i] = temp;
    }

    private void siftDown(int[] list, int start, int end) {
        switch(heap) {
            case MINHEAP:
                siftDownMin(list, <font color='#ff0000' weight='1' id='213'>start<font color='#ff0000' weight='1' id='212'></font></font>, end);
                break;
            case MAXHEAP:
                siftDownMax(list, start, end);
                break;
        }
    }

    private void siftDownMin(int[] list, int start, int end) {
        int root = start;

        while(root * 2 + 1 &lt;= end) {
            int child = root * 2 + 1;
            int swap = root;
            if(list[swap] &gt; list[child]) {
                swap = child;
            }

            if(child + 1 &lt;= end &amp;&amp; list[swap] &gt; list[child + 1]) {
                swap = child + 1;
            }

            if(swap != root) {
                swap(list, root, swap);
                root = swap;
            } else {
                return;
            }
        }
    }



    private void siftDownMax(int[] list, int start, int end) {
        int root = start;

        while(root * 2 + 1 &lt;= end) {
            int child = root * 2 + 1;
            int swap = root;
            if(list[swap] &lt; list[child]) {
                swap = child;
            }

            if(child + 1 &lt;= end &amp;&amp; list[swap] &lt; list[child + 1]) {
                swap = child + 1;
            }

            if(swap != root) {
                swap(list, root, swap);
                root = swap;
            } else {
                return;
            }
        }
    }

    public void heapify(int[] list) {
        int start = (list.length - 2) / 2;
        while(start &gt;= 0) {
            siftDown(list, start, list.length - 1);
            start -= 1;
        }
    }

    public void sort(int[] list) {
        heapify(list);
        int end = list.length - 1;
        while(end &gt; 0) {
            swap(list, end, 0);
            end -= 1;
            siftDown(list, 0, end);
        }
    }

    public static void runList(int[] list, Heap heap) {
        System.out.println("before: " + Arrays.toString(list));
        HeapSortSelectHeap s = new HeapSortSelectHeap(heap);
        s.heapify(list);
        System.out.println("heap: " + Arrays.toString(list));
        s.sort(list);
        System.out.println("after: " + Arrays.toString(list));
    }


}
</font>
</pre>
<pre style='background-color:blue;'>
<font color='blue'>

    public static void sort(int[] a) {
        
        shuffleArray(a);
        sort(a, 0, a.length - 1);
    }

    private static void sort(int[] a, int lo, int hi) {
        
        if(hi &lt;= lo)    return;
        int j = partition(a, lo, hi);
        sort(a, lo, j - 1);
        sort(a, j + 1, hi);
    }

    private static int partition(int[] a, int lo, int hi) {
        int i = lo, j = hi + 1;
        while(true)<font color='#ff0000' weight='1' id='372'>{
            
            <font color='#00cbff' weight='0.2' id='296'>while<font color='#0066ff' weight='0.1' id='279'>(<font color='#0008ff' weight='0.00833333' id='258'>a</font>[<font color='#0004ff' weight='0.00416667' id='260'>lo</font>] <font color='#0010ff' weight='0.0166667' id='266'>&gt; </font><font color='#0008ff' weight='0.00833333' id='268'>a</font>[<font color='#0002ff' weight='0.00208333' id='270'>++<font color='#0002ff' weight='0.00208333' id='269'></font></font><font color='#0002ff' weight='0.00208333' id='272'>i</font>]) </font><font color='#0066ff' weight='0.1' id='295'>{
                <font color='#0033ff' weight='0.05' id='293'>if<font color='#0019ff' weight='0.025' id='288'>(<font color='#000cff' weight='0.0125' id='286'><font color='#0004ff' weight='0.00416667' id='281'>i </font><font color='#0004ff' weight='0.00416667' id='283'>== </font><font color='#0004ff' weight='0.00416667' id='285'>hi</font>)</font><font color='#000cff' weight='0.0125' id='287'></font></font><font color='#0019ff' weight='0.025' id='292'> <font color='#0019ff' weight='0.025' id='291'><font color='#0019ff' weight='0.025' id='290'>break;<font color='#0019ff' weight='0.025' id='289'></font></font></font></font>
            }</font><font color='#0033ff' weight='0.05' id='294'></font></font>
            
            </font><font color='#00cbff' weight='0.2' id='336'>while<font color='#0066ff' weight='0.1' id='319'>(<font color='#0008ff' weight='0.00833333' id='298'>a</font>[<font color='#0004ff' weight='0.00416667' id='300'>lo</font>] &lt; <font color='#0008ff' weight='0.00833333' id='308'>a</font>[<font color='#0002ff' weight='0.00208333' id='310'>--</font><font color='#0002ff' weight='0.00208333' id='312'>j<font color='#0002ff' weight='0.00208333' id='311'></font></font>]) </font><font color='#0066ff' weight='0.1' id='335'>{
                <font color='#0033ff' weight='0.05' id='333'>if<font color='#0019ff' weight='0.025' id='328'>(<font color='#000cff' weight='0.0125' id='326'><font color='#0004ff' weight='0.00416667' id='321'>j </font><font color='#0004ff' weight='0.00416667' id='323'>== </font><font color='#0004ff' weight='0.00416667' id='325'>lo</font>)</font><font color='#000cff' weight='0.0125' id='327'></font></font><font color='#0019ff' weight='0.025' id='332'> <font color='#0019ff' weight='0.025' id='331'><font color='#0019ff' weight='0.025' id='330'>break;<font color='#0019ff' weight='0.025' id='329'></font></font></font></font>
            }</font><font color='#0033ff' weight='0.05' id='334'></font></font>
            
            </font>if(<font color='#0010ff' weight='0.0166667' id='338'>j </font><font color='#0010ff' weight='0.0166667' id='340'>&lt;= </font><font color='#0010ff' weight='0.0166667' id='342'>i</font>) <font color='#0066ff' weight='0.1' id='348'><font color='#0066ff' weight='0.1' id='347'>break;<font color='#0066ff' weight='0.1' id='346'></font></font></font>
            
            <font color='#0033ff' weight='0.05' id='352'>exch</font>(<font color='#000cff' weight='0.0125' id='354'>a</font>, <font color='#000cff' weight='0.0125' id='358'>i</font>, <font color='#000cff' weight='0.0125' id='362'>j</font>);
        }<font color='#00cbff' weight='0.2' id='371'></font></font>
        
        exch(a, lo, j);
        return j;
    }

    private static void exch(int[] a, int i, int j) {
        int temp = a[i];
        a[i] = a[j];
        a[j] = temp;
    }</font>
</pre>

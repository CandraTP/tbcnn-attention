<pre style='background-color:blue;'>
<font color='blue'>
package chapter4.section2;

import chapter1.section3.Queue;
import edu.princeton.cs.algs4.StdOut;


public class Exercise39_QueueBasedTopologicalSort {

    private int[] ranks;

    
    public int[] topologicalSort(Digraph digraph) <font color='#ff0000' weight='1' id='558'>{

        <font color='#ff0000' weight='1' id='100'>DirectedCycle<font color='#ff0000' weight='1' id='80'></font> directedCycle<font color='#ff0000' weight='1' id='83'></font> = <font color='#ff0000' weight='1' id='96'>new<font color='#ff0000' weight='1' id='85'></font> <font color='#ff0000' weight='1' id='95'>DirectedCycle<font color='#ff0000' weight='1' id='87'></font><font color='#ff0000' weight='1' id='94'>(<font color='#ff0000' weight='1' id='92'><font color='#ff0000' weight='1' id='91'><font color='#ff0000' weight='1' id='90'>digraph<font color='#ff0000' weight='1' id='89'></font></font></font>)</font><font color='#ff0000' weight='1' id='93'></font></font></font></font>;<font color='#ff0000' weight='1' id='99'></font>
        </font><font color='#ff0000' weight='1' id='122'>if<font color='#ff0000' weight='1' id='113'>(<font color='#ff0000' weight='1' id='111'><font color='#ff0000' weight='1' id='110'><font color='#ff0000' weight='1' id='107'><font color='#ff0000' weight='1' id='102'>directedCycle<font color='#ff0000' weight='1' id='101'></font></font><font color='#ff0000' weight='1' id='104'>.<font color='#ff0000' weight='1' id='103'></font></font>hasCycle<font color='#ff0000' weight='1' id='105'></font></font><font color='#ff0000' weight='1' id='109'>()<font color='#ff0000' weight='1' id='108'></font></font></font>)</font><font color='#ff0000' weight='1' id='112'></font></font><font color='#ff0000' weight='1' id='121'> <font color='#ff0000' weight='1' id='120'>{
            
            <font color='#ff0000' weight='1' id='118'>return <font color='#ff0000' weight='1' id='115'>null<font color='#ff0000' weight='1' id='114'></font></font>;<font color='#ff0000' weight='1' id='117'></font>
        }</font></font></font>

        </font><font color='#ff0000' weight='1' id='153'><font color='#ff0000' weight='1' id='128'><font color='#ff0000' weight='1' id='127'>int<font color='#ff0000' weight='1' id='123'></font><font color='#ff0000' weight='1' id='126'>[]<font color='#ff0000' weight='1' id='125'></font></font></font> </font><font color='#ff0000' weight='1' id='130'>indegree<font color='#ff0000' weight='1' id='129'></font> </font>= new int<font color='#ff0000' weight='1' id='147'>[<font color='#ff0000' weight='1' id='145'><font color='#ff0000' weight='1' id='144'><font color='#ff0000' weight='1' id='141'>digraph<font color='#ff0000' weight='1' id='138'>.</font><font color='#ff0000' weight='1' id='140'>vertices</font></font>()<font color='#ff0000' weight='1' id='142'></font></font>]</font><font color='#ff0000' weight='1' id='146'></font></font>;
        </font><font color='#ff0000' weight='1' id='162'><font color='#ff0000' weight='1' id='161'>Queue&lt;<font color='#ff0000' weight='1' id='158'>Integer&gt;</font><font color='#ff0000' weight='1' id='159'></font></font> </font><font color='#ff0000' weight='1' id='164'>sources </font>= <font color='#ff0000' weight='1' id='166'>new<font color='#ff0000' weight='1' id='165'></font> </font><font color='#ff0000' weight='1' id='174'><font color='#ff0000' weight='1' id='168'>Queue<font color='#ff0000' weight='1' id='167'></font></font><font color='#ff0000' weight='1' id='170'>&lt;&gt;</font>()<font color='#ff0000' weight='1' id='172'></font></font>;<font color='#ff0000' weight='1' id='178'></font>

        <font color='#ff0000' weight='1' id='204'>ranks = <font color='#ff0000' weight='1' id='185'>new </font><font color='#ff0000' weight='1' id='201'>int[<font color='#ff0000' weight='1' id='194'><font color='#ff0000' weight='1' id='189'>digraph</font>.<font color='#ff0000' weight='1' id='190'></font><font color='#ff0000' weight='1' id='193'>vertices</font></font><font color='#ff0000' weight='1' id='196'>()</font>]</font>;<font color='#ff0000' weight='1' id='203'></font>

        </font><font color='#ff0000' weight='1' id='210'><font color='#ff0000' weight='1' id='206'>int</font>[] </font>topologicalSort = <font color='#ff0000' weight='1' id='214'>new </font><font color='#ff0000' weight='1' id='230'>int<font color='#ff0000' weight='1' id='215'></font>[<font color='#ff0000' weight='1' id='227'><font color='#ff0000' weight='1' id='226'><font color='#ff0000' weight='1' id='223'>digraph.<font color='#ff0000' weight='1' id='219'></font><font color='#ff0000' weight='1' id='222'>vertices</font></font>()</font>]</font></font>;
        <font color='#ff0000' weight='1' id='247'><font color='#ff0000' weight='1' id='238'><font color='#ff0000' weight='1' id='237'>int<font color='#ff0000' weight='1' id='236'></font></font> </font>topologicalSortIndex<font color='#ff0000' weight='1' id='239'></font> = <font color='#ff0000' weight='1' id='243'><font color='#ff0000' weight='1' id='242'>0</font></font>;<font color='#ff0000' weight='1' id='246'></font>

        </font><font color='#ff0000' weight='1' id='328'>for<font color='#ff0000' weight='1' id='284'>(<font color='#ff0000' weight='1' id='259'><font color='#ff0000' weight='1' id='257'><font color='#ff0000' weight='1' id='249'>int</font> vertex<font color='#ff0000' weight='1' id='251'></font> = <font color='#ff0000' weight='1' id='255'>0<font color='#ff0000' weight='1' id='253'></font></font>;</font> </font><font color='#ff0000' weight='1' id='276'><font color='#ff0000' weight='1' id='274'><font color='#ff0000' weight='1' id='261'>vertex </font><font color='#ff0000' weight='1' id='263'>&lt;<font color='#ff0000' weight='1' id='262'></font> </font><font color='#ff0000' weight='1' id='270'><font color='#ff0000' weight='1' id='265'>digraph</font>.<font color='#ff0000' weight='1' id='266'></font><font color='#ff0000' weight='1' id='269'>vertices<font color='#ff0000' weight='1' id='268'></font></font></font>()<font color='#ff0000' weight='1' id='271'></font>;</font><font color='#ff0000' weight='1' id='275'></font> </font><font color='#ff0000' weight='1' id='278'>vertex<font color='#ff0000' weight='1' id='277'></font></font>++<font color='#ff0000' weight='1' id='279'></font>) </font><font color='#ff0000' weight='1' id='327'>{
            for<font color='#ff0000' weight='1' id='309'>(<font color='#ff0000' weight='1' id='307'>int neighbor <font color='#ff0000' weight='1' id='305'>: <font color='#ff0000' weight='1' id='304'><font color='#ff0000' weight='1' id='303'>digraph<font color='#ff0000' weight='1' id='290'></font><font color='#ff0000' weight='1' id='293'>.<font color='#ff0000' weight='1' id='292'></font></font><font color='#ff0000' weight='1' id='295'>adjacent</font><font color='#ff0000' weight='1' id='302'>(<font color='#ff0000' weight='1' id='300'><font color='#ff0000' weight='1' id='299'>vertex</font>)</font><font color='#ff0000' weight='1' id='301'></font></font></font></font></font>)</font><font color='#ff0000' weight='1' id='308'></font> </font><font color='#ff0000' weight='1' id='324'>{
                <font color='#ff0000' weight='1' id='322'><font color='#ff0000' weight='1' id='320'><font color='#ff0000' weight='1' id='311'>indegree<font color='#ff0000' weight='1' id='310'></font></font>[<font color='#ff0000' weight='1' id='314'><font color='#ff0000' weight='1' id='313'>neighbor</font>]</font><font color='#ff0000' weight='1' id='315'></font><font color='#ff0000' weight='1' id='319'>++<font color='#ff0000' weight='1' id='318'></font></font>;</font><font color='#ff0000' weight='1' id='321'></font>
            }</font><font color='#ff0000' weight='1' id='323'></font></font>
        }</font>

        </font><font color='#ff0000' weight='1' id='404'>for<font color='#ff0000' weight='1' id='365'>(<font color='#ff0000' weight='1' id='340'><font color='#ff0000' weight='1' id='331'>int<font color='#ff0000' weight='1' id='329'></font> </font><font color='#ff0000' weight='1' id='333'>vertex </font>= <font color='#ff0000' weight='1' id='336'>0<font color='#ff0000' weight='1' id='334'></font></font>;<font color='#ff0000' weight='1' id='339'></font> </font><font color='#ff0000' weight='1' id='357'><font color='#ff0000' weight='1' id='355'><font color='#ff0000' weight='1' id='342'>vertex<font color='#ff0000' weight='1' id='341'></font> </font><font color='#ff0000' weight='1' id='344'>&lt; </font><font color='#ff0000' weight='1' id='354'><font color='#ff0000' weight='1' id='351'>digraph<font color='#ff0000' weight='1' id='348'>.</font><font color='#ff0000' weight='1' id='350'>vertices<font color='#ff0000' weight='1' id='349'></font></font></font><font color='#ff0000' weight='1' id='353'>()<font color='#ff0000' weight='1' id='352'></font></font></font>;</font> </font><font color='#ff0000' weight='1' id='363'><font color='#ff0000' weight='1' id='362'><font color='#ff0000' weight='1' id='359'>vertex<font color='#ff0000' weight='1' id='358'></font></font><font color='#ff0000' weight='1' id='361'>++<font color='#ff0000' weight='1' id='360'></font></font></font>)</font><font color='#ff0000' weight='1' id='364'></font> </font><font color='#ff0000' weight='1' id='403'>{
            <font color='#ff0000' weight='1' id='401'>if<font color='#ff0000' weight='1' id='380'>(<font color='#ff0000' weight='1' id='378'><font color='#ff0000' weight='1' id='373'>indegree<font color='#ff0000' weight='1' id='372'>[vertex]<font color='#ff0000' weight='1' id='371'></font></font> </font><font color='#ff0000' weight='1' id='375'>==<font color='#ff0000' weight='1' id='374'></font> </font>0<font color='#ff0000' weight='1' id='376'></font>)</font><font color='#ff0000' weight='1' id='379'></font></font><font color='#ff0000' weight='1' id='400'> <font color='#ff0000' weight='1' id='399'>{
                <font color='#ff0000' weight='1' id='397'><font color='#ff0000' weight='1' id='395'>sources<font color='#ff0000' weight='1' id='381'></font><font color='#ff0000' weight='1' id='384'>.<font color='#ff0000' weight='1' id='383'></font></font><font color='#ff0000' weight='1' id='386'>enqueue</font><font color='#ff0000' weight='1' id='393'>(<font color='#ff0000' weight='1' id='391'><font color='#ff0000' weight='1' id='390'>vertex<font color='#ff0000' weight='1' id='388'></font></font>)</font></font>;</font>
            }</font><font color='#ff0000' weight='1' id='398'></font></font></font>
        }</font><font color='#ff0000' weight='1' id='402'></font></font>

        </font>while (<font color='#ff0000' weight='1' id='417'><font color='#ff0000' weight='1' id='406'>!<font color='#ff0000' weight='1' id='405'></font></font><font color='#ff0000' weight='1' id='413'>sources<font color='#ff0000' weight='1' id='407'></font><font color='#ff0000' weight='1' id='410'>.<font color='#ff0000' weight='1' id='409'></font></font>isEmpty</font><font color='#ff0000' weight='1' id='415'>()</font>)</font><font color='#ff0000' weight='1' id='418'></font> {
            <font color='#ff0000' weight='1' id='437'><font color='#ff0000' weight='1' id='421'>int</font> <font color='#ff0000' weight='1' id='424'>currentSource </font><font color='#ff0000' weight='1' id='436'>= <font color='#ff0000' weight='1' id='426'>sources<font color='#ff0000' weight='1' id='425'></font></font>.<font color='#ff0000' weight='1' id='427'></font><font color='#ff0000' weight='1' id='430'>dequeue<font color='#ff0000' weight='1' id='429'></font></font><font color='#ff0000' weight='1' id='433'>()<font color='#ff0000' weight='1' id='432'></font></font></font>;</font>

            <font color='#ff0000' weight='1' id='454'><font color='#ff0000' weight='1' id='452'><font color='#ff0000' weight='1' id='441'>ranks<font color='#ff0000' weight='1' id='440'></font></font>[currentSource<font color='#ff0000' weight='1' id='442'></font>] <font color='#ff0000' weight='1' id='449'>= </font><font color='#ff0000' weight='1' id='451'>topologicalSortIndex</font>;</font>
            </font><font color='#ff0000' weight='1' id='471'><font color='#ff0000' weight='1' id='456'>topologicalSort<font color='#ff0000' weight='1' id='455'></font></font>[<font color='#ff0000' weight='1' id='458'>topologicalSortIndex<font color='#ff0000' weight='1' id='457'></font></font>++<font color='#ff0000' weight='1' id='459'></font>] <font color='#ff0000' weight='1' id='466'>=<font color='#ff0000' weight='1' id='465'></font> </font>currentSource;

            </font>for<font color='#ff0000' weight='1' id='496'>(int neighbor <font color='#ff0000' weight='1' id='492'>: <font color='#ff0000' weight='1' id='490'>digraph<font color='#ff0000' weight='1' id='477'></font>.adjacent(<font color='#ff0000' weight='1' id='487'><font color='#ff0000' weight='1' id='485'>currentSource</font>)</font></font></font>) </font><font color='#ff0000' weight='1' id='547'>{
                <font color='#ff0000' weight='1' id='509'><font color='#ff0000' weight='1' id='507'><font color='#ff0000' weight='1' id='498'>indegree<font color='#ff0000' weight='1' id='497'></font></font><font color='#ff0000' weight='1' id='503'>[<font color='#ff0000' weight='1' id='500'>neighbor</font>]</font><font color='#ff0000' weight='1' id='506'>--<font color='#ff0000' weight='1' id='505'></font></font>;</font>

                </font><font color='#ff0000' weight='1' id='545'>if<font color='#ff0000' weight='1' id='524'>(<font color='#ff0000' weight='1' id='522'><font color='#ff0000' weight='1' id='517'><font color='#ff0000' weight='1' id='511'>indegree<font color='#ff0000' weight='1' id='510'></font></font><font color='#ff0000' weight='1' id='516'>[<font color='#ff0000' weight='1' id='514'>neighbor<font color='#ff0000' weight='1' id='512'></font>]</font><font color='#ff0000' weight='1' id='515'></font></font> </font>== <font color='#ff0000' weight='1' id='521'>0<font color='#ff0000' weight='1' id='520'></font></font>)</font><font color='#ff0000' weight='1' id='523'></font></font><font color='#ff0000' weight='1' id='544'> <font color='#ff0000' weight='1' id='543'>{
                    <font color='#ff0000' weight='1' id='539'><font color='#ff0000' weight='1' id='538'><font color='#ff0000' weight='1' id='531'><font color='#ff0000' weight='1' id='526'>sources</font><font color='#ff0000' weight='1' id='528'>.<font color='#ff0000' weight='1' id='527'></font></font><font color='#ff0000' weight='1' id='530'>enqueue<font color='#ff0000' weight='1' id='529'></font></font></font><font color='#ff0000' weight='1' id='537'>(<font color='#ff0000' weight='1' id='535'><font color='#ff0000' weight='1' id='534'>neighbor</font>)</font><font color='#ff0000' weight='1' id='536'></font></font></font>;</font><font color='#ff0000' weight='1' id='540'></font>
                }</font></font>
            }</font><font color='#ff0000' weight='1' id='546'></font></font>
        }

        <font color='#ff0000' weight='1' id='556'>return topologicalSort;
    }</font><font color='#ff0000' weight='1' id='557'></font></font>

}
</font>
</pre>
<pre style='background-color:blue;'>
<font color='blue'>
   public void sort(Object[] arr, Comparator comparator)
    {
        int low = 0;
        int high = arr.length - 1;

        Object[] aux = new Object[arr.length];

        sort(comparator, arr, aux, low, high);
    }

    private void sort(Comparator c, Object[] arr, Object[] aux, int low, int high)
    {
        if (high &lt;= low)
        {
            return;
        }

        int mid = low + (high - low) / 2;
        sort(c, arr, aux, low, mid);
        sort(<font color='#ff0000' weight='1' id='245'><font color='#ff0000' weight='1' id='244'><font color='#ff0000' weight='1' id='243'>c<font color='#ff0000' weight='1' id='242'></font></font></font>, </font>arr, aux, mid + 1, high);

        if (!less(c, arr[mid + 1], arr[mid]))
        {
            return;
        }

        merge(c, arr, aux, low, mid, high);
    }

    private void merge(Comparator c, Object[] arr, Object[] aux, int low, int mid, int high)
    {
        assert isSorted(c, arr, low, mid);
        assert isSorted(c, arr, mid + 1, high);

        for (int k = low; k &lt;= high; k++)
        {
            aux[k] = arr[k];
        }

        int i = low;
        int j = mid + 1;

        for (int k = low; k &lt;= high; k++)
        {
            if (i &gt; mid)
            {
                arr[k] = aux[j++];
            }
            else if (j &gt; high)
            {
                arr[k] = aux[i++];
            }
            else if (less(c, aux[j], aux[i]))
            {
                arr[k] = aux[j++];
            }
            else
            {
                arr[k] = aux[i++];
            }
        }

        assert isSorted(c, arr, low, high);
    }

    private Boolean isSorted(Comparator c, Object[] arr, int low, int high)
    {
        for (int i = low + 1; i &lt;= high; i++)
        {
            if (less(c, arr[i], arr[i - 1]))
            {
                return false;
            }
        }

        return true;
    }</font>
</pre>
